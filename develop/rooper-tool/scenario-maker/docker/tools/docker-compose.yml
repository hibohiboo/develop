version: '3'
services:

  # 構文チェック
  lint:
    build: ./lint
    volumes: 
      - ./lint/package.json:/home/workdir/package.json
      - ./config/.eslintrc:/home/workdir/.eslintrc
      - ../../src/browser:/home/workdir/src

  # トランスパイラ
  babel:
    build: ./babel
    volumes:
      - ./config/.babelrc:/home/workdir/.babelrc
      - ./babel/package.json:/home/workdir/package.json
      - ../../public:/home/workdir/public
      - ../../src:/home/workdir/src
      - ../../dist:/home/workdir/dist
    environment:
      - CHOKIDAR_USEPOLLING=true # watchするときにdocker上のファイル更新を検知のために必要。
    # srcディレクトリを監視してdistディレクトリにトランスパイル後のファイルを出力する
    # command: npm run watch:compact
  # awsへの接続を行う
  awscli:
    build: ./aws-cli  
    volumes:
      - ../../public:/public
      - ../../aws-cli/.aws:/root/.aws
      - ../../aws-cli/conf:/conf